<main class="main-content">
    <div class="container">
        <div class="page-header" style="text-align: center; margin-bottom: 2rem;">
            <h2>๐ฅ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
            <p>ุนุฑุถ ุฌููุน ุงููุณุชุฎุฏููู ุงููุณุฌููู ูุงูุชุญูู ูู ุญุณุงุจุงุชูู.</p>
        </div>

        <div style="background-color: var(--bg-surface); padding: 2rem; border-radius: var(--border-radius); box-shadow: var(--shadow);">
            <% if (users && users.length > 0) { %>
                <div style="overflow-x: auto;">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ุงูุงุณู</th>
                                <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                                <th>ุฑูู ุงููุงุชู</th>
                                <th>ุชุงุฑูุฎ ุงูุชุณุฌูู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% users.forEach(user => { %>
                                <!-- ูุง ูุนุฑุถ ุญุณุงุจุงุช ุงููุฏุฑุงุก ุงูุขุฎุฑูู ูุชุฌูุจ ุฅููุงููู ุจุงูุฎุทุฃ -->
                                <% if (!user.is_admin) { %>
                                    <tr>
                                        <td class="product-name-cell"><%= user.name %></td>
                                        <td><%= user.email %></td>
                                        <td><%= user.phone %></td>
                                        <td><%= new Date(user.created_at).toLocaleDateString('ar-SA') %></td>
                                        <td>
                                            <% if (user.is_suspended) { %>
                                                <span class="badge badge-hidden">ููููู</span>
                                            <% } else { %>
                                                <span class="badge badge-available">ูุดุท</span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <% if (user.is_suspended) { %>
                                                    <button onclick="unsuspendUser(<%= user.id %>)" class="btn btn-sm btn-success">ุฅูุบุงุก ุงูุฅููุงู</button>
                                                <% } else { %>
                                                    <button onclick="suspendUser(<%= user.id %>)" class="btn btn-sm btn-warning">ุฅููุงู</button>
                                                <% } %>
                                            </div>
                                        </td>
                                    </tr>
                                <% } %>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <p style="text-align: center;">ูุง ููุฌุฏ ูุณุชุฎุฏููู ูุนุฑุถูู.</p>
            <% } %>
        </div>
    </div>
</main>

<script>
    // --- ุฏุงูุฉ ุฅููุงู ุงููุณุชุฎุฏู ---
    function suspendUser(userId) {
        const reason = prompt("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุณุจุจ ุฅููุงู ุงููุณุชุฎุฏู (ุณูุธูุฑ ูู):");
        if (reason && reason.trim() !== '') {
            fetch(`/admin/suspend-user/${userId}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ reason: reason })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert(data.message || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅููุงู ุงููุณุชุฎุฏู.');
                }
            });
        } else if (reason !== null) {
            alert('ูุฌุจ ุฅุฏุฎุงู ุณุจุจ ููุฅููุงู.');
        }
    }

    // --- ุฏุงูุฉ ุฅูุบุงุก ุฅููุงู ุงููุณุชุฎุฏู ---
    function unsuspendUser(userId) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅูุบุงุก ุฅููุงู ูุฐุง ุงููุณุชุฎุฏูุ')) {
            fetch(`/admin/unsuspend-user/${userId}`, {
                method: 'POST'
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert(data.message || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุบุงุก ุงูุฅููุงู.');
                }
            });
        }
    }
</script>