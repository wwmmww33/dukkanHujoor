<main class="main-content">
        <div class="container">
    <h2 style="color: #2c3e50; margin-bottom: 30px;">ููุญุฉ ุชุญูู ุงููุฏูุฑ</h2>
    
    <!-- ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
        <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 25px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);">
            <h3 style="margin: 0; font-size: 2.5rem;"><%= stats.users %></h3>
            <p style="margin: 10px 0 0 0; font-size: 1.1rem;">ุฅุฌูุงูู ุงููุณุชุฎุฏููู</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #27ae60, #229954); color: white; padding: 25px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);">
            <h3 style="margin: 0; font-size: 2.5rem;"><%= stats.available %></h3>
            <p style="margin: 10px 0 0 0; font-size: 1.1rem;">ุงูููุชุฌุงุช ุงููุชุงุญุฉ</p>
        </div>
        
        <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 25px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);">
            <h3 style="margin: 0; font-size: 2.5rem;"><%= stats.products %></h3>
            <p style="margin: 10px 0 0 0; font-size: 1.1rem;">ุฅุฌูุงูู ุงูููุชุฌุงุช</p>
        </div>
    </div>
    
    <!-- ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #2c3e50; margin-bottom: 20px;">๐๏ธ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h3>
        
        <% if (products && products.length > 0) { %>
            <div style="overflow-x: auto;">
    <table class="admin-table"> <!-- Using a class for styling -->
        <thead>
            <tr>
                <th>ุงูุตูุฑุฉ</th>
                <th>ุงุณู ุงูููุชุฌ</th>
                <th>ุงููุงูู</th>
                <th>ุงูุณุนุฑ</th>
                <th>ุงูุญุงูุฉ (ุฌุฏูุฏ/ูุณุชุนูู)</th> <!--  <-- 1. ุงูุฎุงูุฉ ุงูุฌุฏูุฏุฉ  -->
                <th>ุงูุญุงูุฉ (ูุชุงุญ/ูุจุงุน)</th>
                <th>ุงูุฅุฌุฑุงุกุงุช</th>
            </tr>
        </thead>
        <tbody>
            <% products.forEach(product => { %>
                <tr id="product-<%= product.id %>">
                    <td>
                        <% if (product.image_path) { %>
                            <img src="/uploads/<%= product.image_path %>" alt="<%= product.name %>" class="table-product-image">
                        <% } else { %>
                            <div class="table-product-image-placeholder">๐ท</div>
                        <% } %>
                    </td>
                    <td class="product-name-cell"><%= product.name %></td>
                    <td><%= product.user_name %></td>
                    <td class="price-cell"><%= product.price %> ุฑูุงู</td>

                    <!-- ======== 2. ุงุจุฏุฃ ุงูุฅุถุงูุฉ ูู ููุง ======== -->
                    <td>
                        <% if (product.product_condition === 'new') { %>
                            <span class="badge badge-new">ุฌุฏูุฏ</span>
                        <% } else { %>
                            <span class="badge badge-used">ูุณุชุนูู</span>
                        <% } %>
                    </td>
                    <!-- ======== ุงูุชูุช ุงูุฅุถุงูุฉ ======== -->

                    <td>
                        <% if (product.admin_hidden) { %>
                            <span class="badge badge-hidden">ูุฎูู</span>
                        <% } else if (product.status === 'sold') { %>
                            <span class="badge badge-sold">ูุจุงุน</span>
                        <% } else { %>
                            <span class="badge badge-available">ูุชุงุญ</span>
                        <% } %>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <% if (product.admin_hidden) { %>
                                <button onclick="showProduct(<%= product.id %>)" class="btn btn-sm btn-success">ุฅุธูุงุฑ</button>
                            <% } else { %>
                                <button onclick="hideProduct(<%= product.id %>)" class="btn btn-sm btn-warning">ุฅุฎูุงุก</button>
                            <% } %>
                            <button onclick="deleteProduct(<%= product.id %>)" class="btn btn-sm btn-danger">ุญุฐู</button>
                        </div>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</div>
        <% } else { %>
            <p style="text-align: center; color: #666; padding: 40px;">ูุง ุชูุฌุฏ ููุชุฌุงุช ูู ุงููุธุงู</p>
        <% } %>
    </div>
    
    <!-- ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h3 style="color: #2c3e50; margin-bottom: 20px;">ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
           <a href="/admin/manage-users" class="btn btn-primary" style="padding: 15px; font-size: 16px; text-decoration: none;">
    ๐ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
</a>
            
            <button onclick="viewAllProducts()" class="btn btn-success" style="padding: 15px; font-size: 16px;">
                ๐ฆ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
            </button>
            
            <button onclick="manageCategories()" class="btn" style="background-color: #f39c12; color: white; padding: 15px; font-size: 16px;">
                ๐ท๏ธ ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช
            </button>
            
            <button onclick="viewReports()" class="btn" style="background-color: #9b59b6; color: white; padding: 15px; font-size: 16px;">
                ๐ ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช
            </button>
        </div>
    </div>
    <!-- ======== ุจุฏุงูุฉ ูุณู ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช ======== -->
<div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
    <h3 style="color: #2c3e50; margin-bottom: 20px;">๐ท๏ธ ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช</h3>

    <!-- ูููุฐุฌ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ -->
    <form id="addCategoryForm" style="display: flex; gap: 10px; margin-bottom: 20px;">
        <input type="text" id="newCategoryName" class="form-input" placeholder="ุงูุชุจ ุงุณู ุงูุชุตููู ุงูุฌุฏูุฏ..." required>
        <button type="submit" class="btn btn-success">ุฅุถุงูุฉ</button>
    </form>

    <!-- ูุงุฆูุฉ ุงูุชุตูููุงุช ุงูุญุงููุฉ -->
    <ul id="categoryList" style="list-style: none; padding: 0;">
        <% if (categories && categories.length > 0) { %>
            <% categories.forEach(category => { %>
                <li id="category-<%= category.id %>" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee;">
                    <span class="category-name"><%= category.name %></span>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="editCategory(<%= category.id %>, '<%= category.name %>')" class="btn btn-sm btn-warning">ุชุนุฏูู</button>
                        <button onclick="deleteCategory(<%= category.id %>)" class="btn btn-sm btn-danger">ุญุฐู</button>
                    </div>
                </li>
            <% }); %>
        <% } %>
    </ul>
</div>
<!-- ======== ููุงูุฉ ูุณู ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช ======== -->

<!-- ... ูุณู ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ ... -->
    <!-- ูุนูููุงุช ุงููุธุงู -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <h3 style="color: #2c3e50; margin-bottom: 20px;">ูุนูููุงุช ุงููุธุงู</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <div style="padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-right: 4px solid #3498db;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ุญุงูุฉ ุงูุฎุงุฏู</h4>
                <p style="color: #27ae60; font-weight: bold; margin: 0;">โ ูุนูู ุจุดูู ุทุจูุนู</p>
                <small style="color: #666;">ุขุฎุฑ ูุญุต: ุงูุขู</small>
            </div>
            
            <div style="padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-right: 4px solid #27ae60;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ูุงุนุฏุฉ ุงูุจูุงูุงุช</h4>
                <p style="color: #27ae60; font-weight: bold; margin: 0;">โ ูุชุตูุฉ</p>
                <small style="color: #666;">SQLite Database</small>
            </div>
            
            <div style="padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-right: 4px solid #e74c3c;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ูุณุงุญุฉ ุงูุชุฎุฒูู</h4>
                <p style="color: #f39c12; font-weight: bold; margin: 0;">โ๏ธ ูุชุงุญุฉ</p>
                <small style="color: #666;">ูุฌูุฏ ุงูุตูุฑ: uploads/</small>
            </div>
        </div>
    </div>
    
    <!-- ุชูุจููุงุช ุงููุฏูุฑ -->
    <div style="margin-top: 30px; padding: 20px; background-color: #fff3cd; border-radius: 8px; border-right: 4px solid #ffc107;">
        <h4 style="color: #856404; margin-bottom: 15px;">๐ ููุงู ุงููุฏูุฑ</h4>
        <ul style="color: #856404; margin: 0; padding-right: 20px;">
            <li>ูุฑุงุฌุนุฉ ุงูููุชุฌุงุช ุงูุฌุฏูุฏุฉ ุจุงูุชุธุงู</li>
            <li>ูุชุงุจุนุฉ ุดูุงูู ุงููุณุชุฎุฏููู</li>
            <li>ุชุญุฏูุซ ุงูุชุตูููุงุช ุญุณุจ ุงูุญุงุฌุฉ</li>
            <li>ูุฑุงูุจุฉ ุฃุฏุงุก ุงููุธุงู</li>
            <li>ุฅุฌุฑุงุก ูุณุฎ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ</li>
        </ul>
    </div>
</div>

<script>
    function viewAllUsers() {
        showAlert('ููุฒุฉ ุนุฑุถ ุงููุณุชุฎุฏููู ุณุชููู ูุชุงุญุฉ ูุฑูุจุงู', 'info');
    }
    
    function viewAllProducts() {
        showAlert('ููุฒุฉ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช ุณุชููู ูุชุงุญุฉ ูุฑูุจุงู', 'info');
    }
    
    function manageCategories() {
        showAlert('ููุฒุฉ ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช ุณุชููู ูุชุงุญุฉ ูุฑูุจุงู', 'info');
    }
    
    function viewReports() {
        showAlert('ููุฒุฉ ุงูุชูุงุฑูุฑ ุณุชููู ูุชุงุญุฉ ูุฑูุจุงู', 'info');
    }
        document.getElementById('addCategoryForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const nameInput = document.getElementById('newCategoryName');
        const name = nameInput.value.trim();
        if (!name) return;

        const response = await fetch('/admin/categories', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name })
        });
        const data = await response.json();
        if (data.success) {
            location.reload(); // ุฃุณูู ุทุฑููุฉ ูุชุญุฏูุซ ุงููุงุฆูุฉ
        } else {
            alert(data.message);
        }
    });

    async function editCategory(id, currentName) {
        const newName = prompt('ุฃุฏุฎู ุงูุงุณู ุงูุฌุฏูุฏ ููุชุตููู:', currentName);
        if (newName && newName.trim() !== '' && newName.trim() !== currentName) {
            const response = await fetch(`/admin/categories/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name: newName.trim() })
            });
            const data = await response.json();
            if (data.success) {
                document.querySelector(`#category-${id} .category-name`).textContent = newName.trim();
            } else {
                alert(data.message);
            }
        }
    }

    async function deleteCategory(id) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุชุตูููุ ุณูุชู ุฅุฒุงูุฉ ูุฐุง ุงูุชุตููู ูู ุฌููุน ุงูููุชุฌุงุช ุงููุฑุชุจุทุฉ ุจู.')) {
            const response = await fetch(`/admin/categories/${id}`, {
                method: 'DELETE'
            });
            const data = await response.json();
            if (data.success) {
                document.getElementById(`category-${id}`).remove();
            } else {
                alert(data.message);
            }
        }
    }
    // ุฅุฎูุงุก ููุชุฌ
    function hideProduct(productId) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅุฎูุงุก ูุฐุง ุงูููุชุฌุ ูู ูุชููู ุงููุณุชุฎุฏู ูู ุฅุนุงุฏุฉ ุนุฑุถู.')) {
            fetch(`/admin/hide-product/${productId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('ุญุฏุซ ุฎุทุฃ ูู ุฅุฎูุงุก ุงูููุชุฌ');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ุญุฏุซ ุฎุทุฃ ูู ุฅุฎูุงุก ุงูููุชุฌ');
            });
        }
    }
    
    // ุฅุธูุงุฑ ููุชุฌ
    function showProduct(productId) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅุธูุงุฑ ูุฐุง ุงูููุชุฌุ')) {
            fetch(`/admin/show-product/${productId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('ุญุฏุซ ุฎุทุฃ ูู ุฅุธูุงุฑ ุงูููุชุฌ');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ุญุฏุซ ุฎุทุฃ ูู ุฅุธูุงุฑ ุงูููุชุฌ');
            });
        }
    }
    
    // ุญุฐู ููุชุฌ
    function deleteProduct(productId) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูููุชุฌ ููุงุฆูุงูุ ูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู.')) {
            fetch(`/admin/delete-product/${productId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`product-${productId}`).remove();
                    alert('ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ');
                } else {
                    alert('ุญุฏุซ ุฎุทุฃ ูู ุญุฐู ุงูููุชุฌ');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ุญุฏุซ ุฎุทุฃ ูู ุญุฐู ุงูููุชุฌ');
            });
        }
    }
    
    // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ูู 30 ุซุงููุฉ
    setInterval(() => {
        // ูููู ุฅุถุงูุฉ ุงุณุชุฏุนุงุก AJAX ูุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
        console.log('ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช...');
    }, 30000);
</script>
        </div>
    </main>